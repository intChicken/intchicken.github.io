---
published: true
title: 토비의스프링3.1 - 2장 테스트
layout: post
author: Dongyeob Park
category: spring
tags: spring study book

---

### '테스트'의 중요성
- 스프링이 개발자에게 제공하는 가장 중요한 가치가 무엇이냐고 물을 경우, 저자는 주저하지 않고 '객체지향'과 '테스트'라고 대답할 것이라고 함
- 스프링으로 개발을 하면서 테스트를 만들지 않는다면 이는 스프링이 지닌 가치의 절반을 포기하는 셈

### '테스트'란?
- 내가 예상하고 의도했던 대로 코드가 정확히 동작하는지를 확인해서, 만든코드를 확신할 수 있게 해주는 작업
- 테스트의 결과가 원하는 대로 나오지 않는 경우에는 코드나 설계에 결함이 있음을 알 수 있다
- 이를 통해 코드의 결함을 제거해가는 작업, 일명 디버깅을 거치게 되고, 결국 최종적으로 테스트가 성공하면 모든 결함이 제거됐다는 확신을 얻을 수 있다
- "테스트란 개발자가 마음 편하게 잠자리에 들 수 있게 해주는 것"
- 만들어진 코드의 기능을 모두 점검할 수 있는 '포괄적인 테스트'를 만들면서부터는, 개발한 애플리케이션은 이후에 어떤 과감한 수정을 하고 나서도 테스트를 모두 돌려보고 나면 안심이 된다

### 단위 테스트
- 단위 테스트 : 작은 단위의 코드에 대해 테스트를 수행한 것
- 테스트하고자 하는 대상이 명확하다면 그 대상에만 집중해서 테스트하는 것이 바람직하다
- 단위 테스트를 하는 이유 : 개발자가 설계하고 만든 코드가 원래 의도한 대로 동작하는지를 개발자 스스로 빨리 확인받기 위함
- 단위 테스트는 항상 일관성 있는 결과가 보장돼야 한다는 점을 잊어선 안 된다. DB에 남아 있는 데이터와 같은 외부 환경에 영향을 받지 말아야 하는 것은 물론이고, 테스트를 실행하는 순서를 바꿔도 동일한 결과가 보장되도록 만들어야 한다

### 자동수행 테스트 코드
- 테스트는 자동으로 수행되도록 코드로 만들어지는 것이 중요
- 장점 : 자주 반복 가능

### '테스트 에러'와 '테스트 실패'
- 테스트 에러 : 테스트가 진행되는 동안에 에러가 발생
- 테스트 실패 : 결과가 기대한 것과 다르게 나오는 경우

### JUnit
- JUnit : 자바로 단위 테스트를 만들 때 유용하게 쓸 수 있다
- JUnit은 프레임워크다. 프레임워크의 기본 동작원리가 바로 제어의 역전(IoC). 그러므로 JUnit을 통해서 테스트의 제어권을 main으로 부터 분리한다
- JUnit은 사실상 자바의 표준 테스팅 프레임워크라고 불릴 만큼 폭넓게 사용되고 있다.
- 스프링의 핵심 기능 중 하니인 '스프링 테스트 모듈'도 JUnit을 이용한다. 따라서 스프링의 기능을 익히기 위해서라도 JUnit은 꼭 사용할 줄 알아야 한다.
- 대부분의 자바 IDE는 JUnit 테스트를 손쉽게 실행할 수 있는 JUnit 테스트 지원 기능을 내장하고 있어서 더욱 편리하게 JUnit 테스트를 만들고 활용할 수 있게 해준다.
- 가장 좋은 JUnit 테스트 실행 방법 : 자바 IDE에 내장된 JUnit 테스트 지원 도구를 사용하는 것

### JUnit의 테스트 메소드
- 1. 메소드는 public으로 선언
- 2. 메소드에 @Test라는 애노테이션을 붙임

### 테스트 메소드의 실행 순서
- JUnit은 특정한 테스트 메소드의 실행 순서를 보장해주지 않는다.
- 테스트의 결과가 테스트 실행 순서에 영향을 받는다면 테스트를 잘못 만든 것이다.
- 모든 테스트는 실행 순서에 상관없이 독립적으로 항상 동일한 결과를 낼 수 있도록 해야 한다.

### 네거티브 테스트
- "항상 네거티브 테스트를 먼저 만들라"
- 테스트를 작성할 때 부정적인 케이스를 먼저 만드는 습관을 들이는 게 좋다

### 테스트 주도 개발 (TDD)
- 테스트 주도 개발 : 만들고자 하는 기능의 내용을 담고 있으면서 만들어진 코드를 검증도 해줄 수 있도록 테스트 코드를 먼저 만들고, 테스트를 성공하게 해주는 코드를 작성하는 방식의 개발 방법
- TDD는 아예 테스트를 먼저 만들고 그 테스트가 성공하도록 하는 코드만 만드는 식으로 진행하기 때문에 테스트를 빼먹지 않고 꼼꼼하게 만들어낼 수 있다. 또한 테스트를 작성하는 시간과 애플리케이션 코드를 작성하는 시간의 간격이 짧아진다.

### JUnit이 하나의 테스트 클래스를 가져와 테스트를 수행하는 방식
- 1. 테스트 클래스에서 @Test가 붙은 public이고 void형이며 파라미터가 없는 테스트 메소드를 모두 찾는다
- 2. 테스트 클래스의 오브젝트를 하나 만든다 (순서는 없다)
- 3. @Before가 붙은 메소드가 있으면 실행
- 4. @Test가 붙은 메소드를 하나 호출하고 테스트 결과를 저장해둠
- 5. @After가 붙은 메소드가 있으면 실행
- 6. 나머지 테스트 메소드에 대해 2~5번을 반복
- 7. 모든 테스트의 결과를 종합해서 돌려줌

### 테스트의 독립 실행 보장
- 테스트 메소드를 실행할 때마다 테스트 클래스의 오브젝트는 새로 만들어진다
- 왜냐하면, JUnit 개발자는 각 테스트가 서로 영향을 주지 않고 독립적으로 실행됨을 확실히 보장해주기 위해 매번 새로운 오브젝트를 만들게 했기 때문

### 테스트 메소드에서 애플리케이션 컨텍스트를 공유해서 사용 가능
- 테스트의 독립 실행을 보장하기에 애플리케이션 컨텍스트도 매번 새로 생성
- 애플리케이션 컨텍스트가 생성되는데 시간이 오래 걸릴 경우, 테스트도 시간이 오래 걸리게 된다. 그러므로 모든 테스트에서 하나의 애플리케이션 컨텍스트를 공유해서 사용하게 되면 테스트 시간을 줄일 수 있다.
- 여러가지 구현 방법이 있지만, 스프링이 직접 제공하는 '애플리케이션 컨텍스트 테스트 지원 기능'을 사용하는 것이 편리하다

### @Autowired
- 컨텍스트의 빈을 테스트 오브젝트에 DI 할 수 있다

### DB를 다루는 애플리케이션 컨텍스트의 테스트
- 애플리케이션 컨텍스트를 2개 만들어서 테스트용 설정 파일에는 테스트용 애플리케이션 컨텍스트를 사용하게끔 한다

### 학습 테스트
- 학습 테스트 : 자신이 만들지 않은 프레임워크나 다른 개발팀에서 만들어서 제공한 라이브러리 등에 대하여 작성하는 테스트
- 목적 : 자신이 사용할 API나 프레임워크의 기능을 테스트로 보면서 사용 방법을 익히려는 것
- 학습 테스트는 테스트 대상보다는 테스트 코드 자체에 관심을 갖고 만들어야 한다
- 장점
  - 다양한 조건에 따른 기능을 손쉽게 확인 가능
  - 학습 테스트 코드를 개발 중에 참고 가능
  - 프레임워크나 제품을 업그레이드할 때 호환성 검증을 도와줌
  - 테스트 작성에 대한 좋은 훈련이 됨
  - 새로운 기술을 공부하는 과정이 즐거워짐

### 203p.의 리스트 2-27에 대한 의문점
- 리스트 2-26의 junit.xml 파일을 리스트 2-27에 선언하거나 사용한 부분이 없다
- 애플리케이션 컨텍스트가 하나일꺼라고 가정한건가?

### 버그 테스트
- 버그 테스트 : 코드에 오류가 있을 때 그 오류를 가장 잘 드러내줄 수 있는 테스트
- 버그 테스트는 일단 실패하도록 만들어야 한다. 버그가 원인이 되서 테스트가 실패하는 코드를 만드는 것이다
- 동등분할 : 같은 결과를 내는 값의 범위를 구분해서 각 대표 값으로 테스트를 하는 방법
- 경계값 분석 : 에러는 동등분할 범위의 경계에서 주로 많이 발생한다는 특징을 이용해서 경계의 근처에 있는 값을 이용해 테스트하는 방법
